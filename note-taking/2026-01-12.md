# Introduction développement mobile

## Différence entre application normale et mobile

Plusieurs différences :

- Interface utilisateur adaptée pour les écrans tactiles petits

- Gestion des ressources limitées

- Fonctionnement en ligne ou hors ligne

- Accès aux capteurs du dispositifs

- Déploiement via des stores

- Expérience utilisateur adaptée aux comportements mobiles (utilisation des doigts au lieu d'une souris...)

## Technologies utilisées

### Web (dont WebAssembly)

Déploiement rapide, accessibilité muiltiplateforme et mise à jour instantanée mais performances limités, accès restreint aux fonctionnalités natives, expérience utilisateur moins fluide.

HTML5, CSS3, JavaScript, Progressive Web Apps, WebAssembly

### Natif Spécifique

- Android (Java)

- iOS (Objective-C, Swift)

### Natif lié

- Kivy (Python)

- Kotlin

### Natif avec runtime

- .NET MAUI (Mono)

- React Native (JavaScript)

- Flutter

## Accès aux fonctionnalités matérielles

ex : Accéder à l'accéléromètre en HTML possible grâce à certaines API mais généralement soumis à des restrictions de sécurité

## Processus de développement

Commencer par la conception avant de coder :

1. Définir les besoins utilisateurs
2. Créer des maquettes
3. Prototyper l'interface
4. Valider les utilisateurs
5. Développer
6. Tester
7. Déployer

### Outils utilisés

- Pencil
- Excalidraw
- Figma
- PowerPoint
- Visio
- Paint
- Autres options (Sketch, Adobe XD, InVision, Marvel, Balsamiq)

## Architecture

### Grocery Store Locator

Frontend + Backend en API Rest qui communique avec la db et éventuellement des services externes (ex : Google Maps API)

Application fictive permettant de trouver le magasin le plus proche qui utiliserait :

- Géolocalistion
- Filtrage par type de magasin
- Recherche par distance
- Recherche de produits spécifiques
- cartographie interactive

## Considérations importantes pour le développement mobile

- Performance optimisée pour els appareils aux ressources limitées
- Expérience utilisateur adaptée aux contraintes mobiles
- Gestion des modes hors ligne et de la synchronisation
- Protection des données de l'appareil et des utilisateurs
- Optimisation pour préserver la batterie
- Vérification sur différents appareils et versions d'OS

# Anatomie d'une Application MAUI

## Introduction

MAUI = Multi-platform Application User Interface. Framework Microsoft qui permet de développer des applications multiplateformes.

## Structure de base d'une application MAUI

Application organisée selon une architecture hiérarchique définie.

### 1. MauiProgram.cs - Point d'entrée

`MauiProgram.cs` est le point d'entrée de l'application. Contient la classe `MauiProgram` avec la méthode statique `CreateMauiApp()`

```csharp
public static class MauiProgram
{
    public static MauiApp CreateMauiApp()
    {
        var builder = MauiApp.CreateBuilder();
        builder
            .UseMauiApp<App>()
            .ConfigureFonts(fonts =>
            {
                fonts.AddFont("OpenSans-Regular.ttf", "OpenSansRegular");
                fonts.AddFont("OpenSans-Semibold.ttf", "OpenSansSemibold");
            });

        #if DEBUG
            builder.Logging.AddDebug();
        #endif

        return builder.Build();
    }
}
```

Fichier technique et généralement pas nécessaire de modifier sauf pour ajouter des config spécifiques (services ou polices de caractères)

### 2. App.xaml & App.xaml.cs - La définition de l'application

- App.xaml : Contient les ressources globales de l'application (styles, couleurs, templates)
- App.xaml.cs : Contient le code d'initialisation de l'application

Classe `App` définie comme `partial` et hérite de `Application`. Crée la combinaison des 2 fichiers pendant la compilation

```csharp
public partial class App : Application
{
    public App()
    {
        InitializeComponent();

        MainPage = new AppShell();
    }
}
```

#### Classes partielles (partial)

MAUI utilise ce concept. Permet de répartir la définition d'une classe entre plusieurs fichiers :

- `.xaml` contient la partie UI déclarative
- `.xaml.cs` contient la logique de code-behind

Les deux fichiers sont combinés lors de la compilation pour former une classe unique

### 3. AppShell.xaml & AppShell.xaml.cs - La structure de navigation

Le Shell représente la navigation principale de l'application (tabs, flyout menu, routes)

- AppShell.xaml : Définit la structure de navigation (tabs, flyout menu, routes)
- AppShell.xaml.cs : Contient la logique de navigation

```xml

<Shell
        x:Class="MauiAppBasicDefault.AppShell"
        xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
        xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
        xmlns:local="clr-namespace:MauiAppBasicDefault"
        Shell.FlyoutBehavior="Disabled"
        Title="MauiAppBasicDefault">

    <ShellContent
            Title="Home"
            ContentTemplate="{DataTemplate local:MainPage}"
            Route="MainPage"/>
</Shell>
```

Permet de définir :

- Navigation par onglets (TabBar)
- Menu latéral (Flyout)
- Routes de navigation pour la navigation entre pages

### 4. MainPage.xaml & MainPage.xaml.cs - La page principal

Définit la page principale de l'application et son comportement

Exemple de MainPage.xaml :

```xml

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiAppBasicDefault.MainPage">
    <VerticalStackLayout Spacing="25">
        <Image Source="dotnet_bot.png"
               HeightRequest="185"
               SemanticProperties.Description="dot net bot in a race car number eight"/>

        <Label Text="Hello, World!"
               Style="{StaticResource Headline}"
               SemanticProperties.HeadingLevel="Level1"/>

        <Label Text="Welcome to .NET Multi-platform App UI"
               Style="{StaticResource SubHeadline}"
               SemanticProperties.HeadingLevel="Level2"
               SemanticProperties.Description="Welcome to dot net Multi platform App U I"/>

        <Button x:Name="CounterBtn"
                Text="Click me"
                SemanticProperties.Hint="Counts the number of times you click"
                Clicked="OnCounterClicked"/>
    </VerticalStackLayout>
</ContentPage>
```

Exemple de MainPage.xaml.cs :

```csharp
public partial class MainPage : ContentPage
{
    private int count = 0;

    public MainPage()
    {
        InitializeComponent();
    }

    private void OnCounterClicked(object sender, EventArgs e)
    {
        count++;

        if (count == 1)
            CounterBtn.Text = $"Clicked {count} time";
        else
            CounterBtn.Text = $"Clicked {count} times";

        SemanticScreenReader.Announce(CounterBtn.Text);
    }
}
```

#### SemanticScreenReader

`SemanticScreenReader` est une classe utilisataire dans MAUI qui améliore l'accessibilité de l'application. Permet de communiquer avec les technologies d'assistance (ex : lecteurs d'écran sur les différentes plateformes)

Ex :

```csharp
SemanticScreenReader.Announce(CounterBtn.Text);
```

-> Lit à voix haute le texte spécifié via le lecteur d'écran système

-> Permet aux utilisateurs malvoyants d'entendre

-> Annonce les changements importants

## Autres fichiers importants

### Dossiers de projet

- Platforms/ : Code spécifique à chaque plateforme
- Resources/ : Contient les ressources (images, polices, etc.)
- Properties/ : Contient les paramètres du projet
- Dependencies/ : Contient les références et packages utilisés

## Flux d'exécution

1. L'app démarre via `MauiProgram.CreateMauiApp()`
2. L'instance `App` est créée et initialisée
3. `App` crée l'instance de `AppShell` pour la page principale
4. `AppShell` charge la page définie dans son `ShellContent`
5. L'utilisateur interagit avec l'application

## Remarques importantes

- MAUI ≠ MVVM : par défaut MAUI n'implémente pas le pattern MVVM (Model-View-View-Model)
- Fichiers générés automatiquement indiqués par `<auto-generated>` et ne devant pas être modifiés manuellement
- Construction de l'UI : Utiliser XAML pour l'interface et C# pour la logique mais possible de tout faire en C#

# XAML - Extensible Application Markup Language

## Introduction

XAML -> langage de balisage basé sur XML utilisé principalement pour des interface utilisateurs dans les applications Microsoft

## Différences XML et XAML

XML -> Données
XAML -> UI

## Structure de base

XAML suit la structure XML

### XML et balises

Balisage comme en html avec des balises ouvrantes et fermantes et un corps : `<balise>corps</balise>`
Si aucun corps : `<balise />`

Possibilité de mettre des attributs : `<balise attribut="true" />`

## Hiérarchie en "poupées russes"

Comme en HTML en fait lol donc avec des balises dans des balises

```xml
<balise>
    <balise2>corps</balise2>
</balise>

```

## XAML et XML

XAML est du XML et sont donc définies par les namespaces XML.

### Namespaces

Cela définit les ensembles d'éléments disponibles
Trouvable dans l'attribut `xmlns`

```xml

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="HelloMaui1.Crud"
             xmlns:viewModels="clr-namespace:HelloMaui1.ViewModels"
             Title="Crud">

</ContentPage>
```

## Exemples XAML courants

| Description                  | XAML                                                                                                                                                                                                                                            | Rendu                                   |
| ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- |
| Afficher un bouton "quitter" | `<Button Text="quitter" />`                                                                                                                                                                                                                     | [Bouton avec texte "quitter"]           |
| Afficher une grille 2x2      | `<Grid WidthRequest="100" HeightRequest="100"><BoxView Grid.Row="0" Grid.Column="0" /><BoxView Grid.Row="0" Grid.Column="1" Color="Red" /><BoxView Grid.Row="1" Grid.Column="0" Color="Blue" /><BoxView Grid.Row="1" Grid.Column="1" /></Grid>` | [Grille 2x2 avec cases colorées]        |
| Afficher un champ texte      | `<Entry Text="Votre nom" />`                                                                                                                                                                                                                    | [Champ de saisie avec texte par défaut] |

## Points importants à retenir

1. XAML suit la structure XML avec les balises (comme HTML)
2. Les balises peuvent également avoir des propriétés (comme HTML)
3. Les éléments XAML s'organisent de manière hiérarchique
4. Les namespaces définissent les ensembles d'éléments disponibles
5. XAML est utilisé principalement pour décrire des interfaces utilisateurs dans les applications Microsoft

## Exercices

1. 2 attributs dans la balise `ingredient`

```xml
<ingredient quantite="200" allergene="true">noix de pécan </ingredient>
```

2. 3 éléments dans la balise `ingredients`

```xml
<ingredients>
  <ingredient quantite="200" allergene="true">noix de pécan
  </ingredient>
  <ingredient quantite="100">farine</ingredient>
  <ingredient quantite="150">sucre</ingredient>
  <!-- TODO: ajouter le beurre et le chocolat -->
</ingredients>
```

3. Corps de la balise `temps` : 15

```xml
<temps unite="minute">15</temps>
```

4. Interface simple avec un bouton et une étiquette

```xml
<ContentPage ...>
  <Button Text="Cliquez-moi !!" />
  <Label Text="Je suis une étiquette">
</ContentPage>
```
